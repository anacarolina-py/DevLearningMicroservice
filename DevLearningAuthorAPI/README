ğŸ“š Author Microservice â€” DocumentaÃ§Ã£o da RefatoraÃ§Ã£o

Este documento descreve as mudanÃ§as realizadas durante a migraÃ§Ã£o e refatoraÃ§Ã£o do microserviÃ§o Author, anteriormente parte de uma API monolÃ­tica em SQL Server, para o novo ecossistema de microserviÃ§os utilizando MongoDB.

ğŸ—ï¸ Contexto da RefatoraÃ§Ã£o

O projeto original consistia em uma API Ãºnica que concentrava mÃºltiplos domÃ­nios. Como parte do processo de quebra em microserviÃ§os, o domÃ­nio Author foi isolado em seu prÃ³prio serviÃ§o.

Durante essa refatoraÃ§Ã£o:

O mÃ³dulo de Author foi migrado de SQL Server para MongoDB.

O repositÃ³rio foi completamente reescrito para o driver do MongoDB.

O service e controller foram mantidos com ajustes mÃ­nimos.

A injeÃ§Ã£o de dependÃªncias foi reestruturada para suportar o novo banco e a comunicaÃ§Ã£o entre microserviÃ§os.

Um endpoint adicional foi criado para possibilitar futura integraÃ§Ã£o com o microserviÃ§o de Course.

ğŸ”„ Principais AlteraÃ§Ãµes
1. ğŸ—„ï¸ MigraÃ§Ã£o de SQL Server para MongoDB

Antes, o serviÃ§o utilizava Dapper com SQL Server.

Agora, a persistÃªncia foi migrada para MongoDB, incluindo:

CriaÃ§Ã£o de modelos compatÃ­veis com documentos MongoDB.

Ajuste das configuraÃ§Ãµes de conexÃ£o em appsettings.json.

CriaÃ§Ã£o de Ã­ndices e coleÃ§Ãµes (quando necessÃ¡rio).

2. ğŸ“ AtualizaÃ§Ã£o da Camada de RepositÃ³rio

O repositÃ³rio foi totalmente adaptado:

SubstituiÃ§Ã£o dos mÃ©todos baseados em Dapper por operaÃ§Ãµes Mongo (Find, InsertOne, ReplaceOne, etc.).

Uso de interfaces para manter o contrato original.

ManutenÃ§Ã£o da assinatura dos mÃ©todos usados pelo serviÃ§o.

3. ğŸ§© Camada de Service e Controller

NÃ£o houve mudanÃ§as significativas nessas camadas:

O comportamento externo do microserviÃ§o foi preservado.

Apenas ajustes pontuais foram feitos para compatibilidade com o novo repositÃ³rio.

ğŸ”— ComunicaÃ§Ã£o com o MicroserviÃ§o de Course

O microserviÃ§o de Author possui uma funcionalidade chamada SelectAuthorByCourse, que na arquitetura original dependia diretamente do banco SQL Server.

Durante a refatoraÃ§Ã£o:

Identificou-se que essa funÃ§Ã£o nÃ£o estava implementada e nÃ£o era utilizada.

Ainda assim, foi criado um endpoint dedicado para futura implementaÃ§Ã£o.

A injeÃ§Ã£o de dependÃªncias agora inclui um HttpClient configurado para consumir o microserviÃ§o de Course, quando necessÃ¡rio.

Endpoint criado
GET /api/course/author/{authorId}


Atualmente, o endpoint retorna um NotImplemented ou uma estrutura bÃ¡sica, mas serve como ponto de integraÃ§Ã£o caso a funcionalidade venha a ser necessÃ¡ria.

ğŸ§© InjeÃ§Ã£o de DependÃªncia

As dependÃªncias foram reorganizadas para:

Registrar o cliente MongoDB e a base.

Adicionar um HttpClient para comunicaÃ§Ã£o com o microserviÃ§o Course.


âœ”ï¸ Status da FunÃ§Ã£o SelectAuthorByCourse

Endpoint criado	âœ”ï¸
IntegraÃ§Ã£o com API Course	âœ”ï¸ (estrutura pronta)
ImplementaÃ§Ã£o da funcionalidade	â³ Ainda nÃ£o necessÃ¡ria
Uso atual no sistema	âŒ NÃ£o utilizada

A decisÃ£o foi manter o endpoint preparado, mas sem lÃ³gica completa, atÃ© que o time valide a real necessidade da funcionalidade.

ğŸ“¦ Estrutura Final do MicroserviÃ§o
/src
  /Controllers
  /Data
  /Services
  /Repositories
  /Models/Dtos


ğŸ“ ConsideraÃ§Ãµes Finais

A refatoraÃ§Ã£o deixou o microserviÃ§o: 
- isolado e independente,

- com armazenamento orientado a documentos (MongoDB),

- preparado para comunicaÃ§Ã£o entre microserviÃ§os,

- pronto para crescimento incremental sem necessidade de retrabalho.
